
> yatrasathi@1.0.0 start
> node src/server.js

[dotenv@17.2.3] injecting env (8) from .env -- tip: ‚úÖ audit secrets and track compliance: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  specify custom .env file path with { path: '/custom/path/.env' }
Environment variables loaded successfully
üîß Configuring MySQL database connections...
  Main Database: yatrasathi
  TVL Database: TVL_001
  Host: localhost
  User: root
  Password: ‚úÖ Configured
Auth routes module loaded
Auth routes registered
Registering auth routes
Auth routes registered
üîå Connecting to MySQL databases...
‚úÖ Main database connected successfully!
   Connected to: yatrasathi@localhost
‚úÖ TVL database connected successfully!
   Connected to: TVL_001@localhost
üîÑ Synchronizing database models...
‚úÖ All models synchronized successfully!
Database connection established
Server running on http://127.0.0.1:5003
Server is listening on: { address: '127.0.0.1', family: 'IPv4', port: 5003 }
Incoming request: POST /api/auth/employee-login
Request headers: {
  host: '127.0.0.1:5003',
  'user-agent': 'curl/8.7.1',
  accept: '*/*',
  'content-type': 'application/json',
  'content-length': '52'
}
TVL employee user login detected: ADM001
Incoming request: GET /api/employees
Request headers: {
  host: '127.0.0.1:5003',
  'user-agent': 'curl/8.7.1',
  accept: '*/*',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IkFETTAwMSIsInJvbGUiOiJBRE0iLCJkZXB0IjoiQURNSU4iLCJkZXNpZ25hdGlvbiI6IkFkbWluaXN0cmF0b3IiLCJ1c2VyVHlwZSI6ImFkbWluIiwiaWF0IjoxNzY3MzY5NDE5LCJleHAiOjE3NjczOTgyMTl9.iyFrf8evQ-9JcoBWyJeH8LTaZXNcrUK-RYAaiLo1Kao'
}
=== Auth Middleware Execution ===
Request headers: {
  host: '127.0.0.1:5003',
  'user-agent': 'curl/8.7.1',
  accept: '*/*',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IkFETTAwMSIsInJvbGUiOiJBRE0iLCJkZXB0IjoiQURNSU4iLCJkZXNpZ25hdGlvbiI6IkFkbWluaXN0cmF0b3IiLCJ1c2VyVHlwZSI6ImFkbWluIiwiaWF0IjoxNzY3MzY5NDE5LCJleHAiOjE3NjczOTgyMTl9.iyFrf8evQ-9JcoBWyJeH8LTaZXNcrUK-RYAaiLo1Kao'
}
Token from header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IkFETTAwMSIsInJvbGUiOiJBRE0iLCJkZXB0IjoiQURNSU4iLCJkZXNpZ25hdGlvbiI6IkFkbWluaXN0cmF0b3IiLCJ1c2VyVHlwZSI6ImFkbWluIiwiaWF0IjoxNzY3MzY5NDE5LCJleHAiOjE3NjczOTgyMTl9.iyFrf8evQ-9JcoBWyJeH8LTaZXNcrUK-RYAaiLo1Kao
Decoded token: {
  id: 'ADM001',
  role: 'ADM',
  dept: 'ADMIN',
  designation: 'Administrator',
  userType: 'admin',
  iat: 1767369419,
  exp: 1767398219
}
Looking for user with ID: ADM001
This is a TVL user, checking TVL database
User from database: {
  us_usid: 'ADM001',
  us_email: 'admin@example.com',
  us_usname: '',
  us_title: '',
  us_phone: '9999999999',
  us_admin: 0,
  us_security: 0,
  us_limit: '100000.00',
  us_rmrks: null,
  us_active: 1,
  us_edtm: 2026-01-02T09:07:16.000Z,
  us_eby: 'SYSTEM',
  us_mdtm: 2026-01-02T09:07:16.000Z,
  us_mby: 'SYSTEM',
  us_fname: 'Admin',
  us_lname: 'User',
  us_aadhaar: '123456789012',
  us_pan: 'ABCDE1234F',
  us_addr1: '123 Admin Street',
  us_city: 'Mumbai',
  us_state: 'Maharashtra',
  us_pin: '400001',
  us_usertype: 'admin',
  us_roid: 'ADM',
  us_coid: 'TRV',
  us_appadmin: 1,
  us_cdtm: null,
  us_cby: ''
}
Auth successful, user type: admin
Full user object: {
  us_usid: 'ADM001',
  us_email: 'admin@example.com',
  us_usname: '',
  us_title: '',
  us_phone: '9999999999',
  us_admin: 0,
  us_security: 0,
  us_limit: '100000.00',
  us_rmrks: null,
  us_active: 1,
  us_edtm: 2026-01-02T09:07:16.000Z,
  us_eby: 'SYSTEM',
  us_mdtm: 2026-01-02T09:07:16.000Z,
  us_mby: 'SYSTEM',
  us_fname: 'Admin',
  us_lname: 'User',
  us_aadhaar: '123456789012',
  us_pan: 'ABCDE1234F',
  us_addr1: '123 Admin Street',
  us_city: 'Mumbai',
  us_state: 'Maharashtra',
  us_pin: '400001',
  us_usertype: 'admin',
  us_roid: 'ADM',
  us_coid: 'TRV',
  us_appadmin: 1,
  us_cdtm: null,
  us_cby: ''
}
Calling next()
Incoming request: GET /api/customers
Request headers: {
  host: '127.0.0.1:5003',
  'user-agent': 'curl/8.7.1',
  accept: '*/*',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IkFETTAwMSIsInJvbGUiOiJBRE0iLCJkZXB0IjoiQURNSU4iLCJkZXNpZ25hdGlvbiI6IkFkbWluaXN0cmF0b3IiLCJ1c2VyVHlwZSI6ImFkbWluIiwiaWF0IjoxNzY3MzY5NDE5LCJleHAiOjE3NjczOTgyMTl9.iyFrf8evQ-9JcoBWyJeH8LTaZXNcrUK-RYAaiLo1Kao'
}
=== Auth Middleware Execution ===
Request headers: {
  host: '127.0.0.1:5003',
  'user-agent': 'curl/8.7.1',
  accept: '*/*',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IkFETTAwMSIsInJvbGUiOiJBRE0iLCJkZXB0IjoiQURNSU4iLCJkZXNpZ25hdGlvbiI6IkFkbWluaXN0cmF0b3IiLCJ1c2VyVHlwZSI6ImFkbWluIiwiaWF0IjoxNzY3MzY5NDE5LCJleHAiOjE3NjczOTgyMTl9.iyFrf8evQ-9JcoBWyJeH8LTaZXNcrUK-RYAaiLo1Kao'
}
Token from header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IkFETTAwMSIsInJvbGUiOiJBRE0iLCJkZXB0IjoiQURNSU4iLCJkZXNpZ25hdGlvbiI6IkFkbWluaXN0cmF0b3IiLCJ1c2VyVHlwZSI6ImFkbWluIiwiaWF0IjoxNzY3MzY5NDE5LCJleHAiOjE3NjczOTgyMTl9.iyFrf8evQ-9JcoBWyJeH8LTaZXNcrUK-RYAaiLo1Kao
Decoded token: {
  id: 'ADM001',
  role: 'ADM',
  dept: 'ADMIN',
  designation: 'Administrator',
  userType: 'admin',
  iat: 1767369419,
  exp: 1767398219
}
Looking for user with ID: ADM001
This is a TVL user, checking TVL database
User from database: {
  us_usid: 'ADM001',
  us_email: 'admin@example.com',
  us_usname: '',
  us_title: '',
  us_phone: '9999999999',
  us_admin: 0,
  us_security: 0,
  us_limit: '100000.00',
  us_rmrks: null,
  us_active: 1,
  us_edtm: 2026-01-02T09:07:16.000Z,
  us_eby: 'SYSTEM',
  us_mdtm: 2026-01-02T09:07:16.000Z,
  us_mby: 'SYSTEM',
  us_fname: 'Admin',
  us_lname: 'User',
  us_aadhaar: '123456789012',
  us_pan: 'ABCDE1234F',
  us_addr1: '123 Admin Street',
  us_city: 'Mumbai',
  us_state: 'Maharashtra',
  us_pin: '400001',
  us_usertype: 'admin',
  us_roid: 'ADM',
  us_coid: 'TRV',
  us_appadmin: 1,
  us_cdtm: null,
  us_cby: ''
}
Auth successful, user type: admin
Full user object: {
  us_usid: 'ADM001',
  us_email: 'admin@example.com',
  us_usname: '',
  us_title: '',
  us_phone: '9999999999',
  us_admin: 0,
  us_security: 0,
  us_limit: '100000.00',
  us_rmrks: null,
  us_active: 1,
  us_edtm: 2026-01-02T09:07:16.000Z,
  us_eby: 'SYSTEM',
  us_mdtm: 2026-01-02T09:07:16.000Z,
  us_mby: 'SYSTEM',
  us_fname: 'Admin',
  us_lname: 'User',
  us_aadhaar: '123456789012',
  us_pan: 'ABCDE1234F',
  us_addr1: '123 Admin Street',
  us_city: 'Mumbai',
  us_state: 'Maharashtra',
  us_pin: '400001',
  us_usertype: 'admin',
  us_roid: 'ADM',
  us_coid: 'TRV',
  us_appadmin: 1,
  us_cdtm: null,
  us_cby: ''
}
Calling next()
